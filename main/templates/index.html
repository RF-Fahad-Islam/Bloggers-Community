{% extends "layout.html" %}
{% from 'includes/macros.html' import render_posts, render_notices %}
{% block title %} <title>{{params["page_title"]}}</title> {% endblock %}
{% block meta %}
<meta name="keywords" content="{{params['app_name']}} blog blogging articles rf-fahad-islam fahad">
<meta name="description" content="Blogsphere is a free platform where anyone can create an account and start blogging. This ensures that all bloggers are equal, allowing them to publish their thoughts on any topic. Anyone can follow other blogs and read updates from across the world with just a few clicks.
">
<meta property="og:title" content="{{params['app_name']}} | A New Blogging Platform" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="{{params['app_url']}}" />
<meta property="og:image" content="/static/images/cover.png" />
<meta property="og:site_name" content="{{params['app_name']}}" />
<meta property="fb:admins" content="USER_ID" />
<meta property="og:description"
  content="Blogsphere is a free platform where anyone can create an account and start blogging. This ensures that all bloggers are equal, allowing them to publish their thoughts on any topic. Anyone can follow other blogs and read updates from across the world with just a few clicks." />
{% endblock meta %}
{% block css %}

<link rel="stylesheet" href="{{url_for('static', filename='css/floating.css')}}">
{% endblock css %}
{% block body %}
<!-- ! Floating Action Button -->
{% if current_user.is_authenticated %}
<div class="floating-container">
  <div class="floating-button"><i class="fa fa-plus"></i></div>
  <div class="element-container">

    <a href="/p/{{current_user.username}}"> <span class="float-element tooltip-left">
        <i class="fa fa-user">
        </i>
    </a>
    <a data-bs-toggle="modal" data-bs-target="#draftModal"> <span class="float-element tooltip-left">
        <i class="fa fa-paperclip">
        </i>
    </a>
    <a href="blog-writer/edit/0"> <span class="float-element tooltip-left">
        <i class="fa fa-pencil">
        </i>
    </a>

  </div>
</div>
{% endif %}
<!-- !Blog Cards -->
<div id="main page" class="container">
  <div class="row my-3">

    <div class="col-lg-12">
      <div class="container-fluid">
        <!-- !Login Alert -->
        {% if not current_user.is_authenticated %}
        <div class="alert alert-primary my-3" role="alert" style="border-radius: 30px;">
          <h4 class="alert-heading">Welcome! You are not logged in!</h4>

          <p>
            <b>
              Login to create your blog profile and create blogs.
            </b>
          </p>
          <hr>
          <div class="flex flex-wrap justify-content-between align-content-center align-items-center">
            <!-- <div>
                <a href="/signup" class="btn btn-warning"><i class="fa fa-user-plus"></i> Sign Up</a>
                <a href="/login" class="btn btn-outline-primary">
                    <i class="fa fa-sign-in"></i> Login</a>
            </div> -->
            <a href="{{url_for('googleLogin')}}" type="btn my-3 text-decoration-none button ml-3"
              style="border-radius: 50px;text-decoration:none;" class="login-with-google-btn">
              Continue with Google
            </a>
          </div>

        </div>
        {% endif %}


        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button"
              role="tab" aria-controls="home" aria-selected="true"><i class="fa fa-rss"></i> Feed</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button"
              role="tab" aria-controls="profile" aria-selected="false"><i class="fa fa-bullhorn"></i> Notices</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button"
              role="tab" aria-controls="contact" aria-selected="false"><i class="fa fa-comments"></i>
              Discussion</button>
          </li>
        </ul>
        <div class="tab-content" id="myTabContent">
          <!-- !All Posts Tab -->
          <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
            <div hx-get="{{url_for('blogs')}}" hx-trigger="load" hx-indicator="#spinner" hx-swap="innerHTML">
              <!-- *Initial Loader -->
              {% for i in range(3) %}

              <div class="card my-3" style="width: 100%;" aria-hidden="true">
                <div class="card-body" style="padding:2rem 1.5rem!important;">
                  <h5 class="card-title placeholder-glow">
                    <span class="placeholder col-6"></span>
                  </h5>
                  <p class="card-text placeholder-glow">
                    <span class="placeholder col-3"></span>
                  </p>
                  <p class="card-text placeholder-glow">
                    <span class="placeholder col-7"></span>
                    <span class="placeholder col-4"></span>
                    <span class="placeholder col-4"></span>
                    <br>
                    <span class="placeholder col-8"></span>
                    <br>
                    <!-- <a href="#" tabindex="-1" class="btn mt-2 disabled placeholder col-2"></a> -->

                  </p>
                </div>
              </div>
              {% endfor %}
            </div>
            <!-- TODO: Loader -->
              <div class="d-flex justify-content-center align-items-center my-2 htmx-indicator" id="spinner">
                <div class="progress-9"></div>
              </div>
          </div>
          <!-- !All Notices Tab -->
          <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            {{render_notices(notices)}}
          </div>

          <!-- !Comments tab -->
          <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
            <div class="card my-3 text-center">
              <h4 class="card-header text-center">Comments / Discussion</h4>
              <div class="card-body">
                <div class="fb-comments" data-href="{{params['url']}}" data-width="" data-numposts="5"></div>
              </div>
            </div>
          </div>


        </div>
      </div>
    </div>
  </div>
</div>
{% endblock body %}
{% block footer %}
<footer class="py-3 bg-light" id="footer" hx-boost="true" >
  <ul class="nav justify-content-center border-bottom pb-3 mb-3">
    <li class="nav-item"><a href="/" class="nav-link px-2 text-muted btn hover-btn">Home</a></li>
    <li class="nav-item"><a href="{{url_for('termsandconditions')}}" class="nav-link px-2 text-muted btn hover-btn">Terms and Conditions</a></li>
    <li class="nav-item"><a href="{{url_for('privacy_policy')}}" class="nav-link px-2 btn text-muted hover-btn">Privacy Policy</a></li>
  </ul>
  <p class="text-center text-muted">Â© 2022 Blogsphere, Inc | Made by Fahad</p><a href="mailto:support@blogsphere.top" class="nav-link px-2 btn text-muted hover-btn">support@blogsphere.top</a>
</footer>
{% endblock footer %}
{% block script %}
<script>
    $('.bookmark').click(() => {
  
      if ($('.bookmark').html() == '<i class="fa fa-bookmark"></i>') {
        $('.bookmark').html(`<i class="fa fa-bookmark-o"></i>`)
  
      } else {
        $('.bookmark').html(`<i class="fa fa-bookmark"></i>`)
  
      }
      let sno = $('.bookmark').attr('id')
      bookmarkReq(sno)
    }
    )
  
    const bookmarkReq = async (sno) => {
      var myHeaders = new Headers();
      myHeaders.append("Cookie", "Cookie_1=value; Cookie_2=value; session=5a67b465-54b3-4ceb-aff3-496d75f28602");
  
  
      var requestOptions = {
        method: 'GET',
        headers: myHeaders,
        credentials: 'include',
        redirect: 'follow'
      };
      
      await fetch("/bookmark?blogsno={{sno}}", requestOptions)
        .then(response => response.json())
        .then(result => {
          let cnt = result["bookmarkCount"]
          $('#bookmarkCount').text(String(cnt))
          console.log(result)
        }
        )
        .catch(error => console.log('error', error));
    }

  
  </script>
{% endblock script %}